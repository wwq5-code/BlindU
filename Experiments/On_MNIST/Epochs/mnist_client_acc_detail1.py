

import numpy as np
import matplotlib.pyplot as plt

epsilon = 3
beta = 1 / epsilon


y_bfu_acc = [0.0003433810197748244, 0.00018197628378402442, 0.2831873297691345, 0.0160256065428257, 6.217150803422555e-05, 0.25421249866485596, 0.0007712826482020319, 0.6996017694473267, 1.788142526493175e-06, 0.02399992011487484, 1.1677584648132324, 0.0001729429786792025, 0.0006256738561205566, 0.1143932044506073, 0.013421189039945602, 0.007847961038351059, 0.0008620895096100867, 1.958518624305725, 0.00018424208974465728, 1.958518624305725, 1.958518624305725, 0.008180507458746433, 0.008229040540754795, 0.00649247458204627, 0.2591709494590759, 0.004330589435994625, 0.06559798866510391, 0.006506000645458698, 1.958518624305725, 0.043689727783203125, 1.958518624305725, 0.11646879464387894, 0.004171889275312424, 0.0006066365167498589, 1.958518624305725, 0.0005132805672474205, 0.007157105952501297, 0.03920840844511986, 3.0100436561042443e-06, 1.958518624305725, 0.011879839934408665, 0.0011082047130912542, 9.776117076398805e-05, 3.188950358889997e-05, 0.1425672471523285, 0.010607783682644367, 1.958518624305725, 0.028521478176116943, 0.0007750137010589242, 1.958518624305725, 0.029730772599577904, 0.01554645411670208, 2.0534222130663693e-05, 0.02008390985429287, 1.958518624305725, 0.035293590277433395, 0.0003648240817710757, 0.04798327013850212, 0.00122458569239825, 0.0013129649451002479, 0.2784520983695984, 2.876006874430459e-05, 0.00781211769208312, 0.14146555960178375, 0.0004444607184268534, 0.014609133824706078, 2.1457717593875714e-06, 0.0018121019238606095, 0.03573596850037575, 0.015508211217820644, 0.22766803205013275, 1.907385012600571e-05, 0.029141223058104515, 0.00263921357691288, 0.0066042267717421055, 0.0003927401849068701, 0.0001405376970069483, 0.01315006148070097, 0.048100460320711136, 0.0471172071993351, 0.06642653793096542, 4.816287400899455e-05, 0.0007644772413186729, 0.0002479870163369924, 0.0012680861400440335, 0.0006965778302401304, 0.005872718524187803, 1.958518624305725, 0.000260689266724512, 0.0016617643414065242, 1.958518624305725, 0.5648903846740723, 0.001622415380552411, 0.007430023979395628, 0.03735915571451187, 0.02002822607755661, 0.015009223483502865, 0.01367816049605608, 5.296153176459484e-05, 0.9848036170005798, 2.682209867543861e-07, 0.002740279072895646, 2.17561682802625e-05, 0.02123991958796978, 0.0011731429258361459, 0.0041010016575455666, 0.00018078376888297498, 1.958518624305725, 0.010045148432254791, 2.2858903321321122e-05, 0.030921977013349533, 0.003948502708226442, 0.004671603906899691, 7.152608759497525e-06, 1.958518624305725, 0.00230667763389647, 0.0021972586400806904, 0.016944531351327896, 0.008067615330219269, 0.023827537894248962, 1.7255842976737767e-05, 0.010585257783532143, 0.0033168294467031956, 0.3093563914299011, 1.1920943734367029e-06, 4.434782385942526e-05, 0.04893602058291435, 0.0028467897791415453, 0.00019563091336749494, 0.029980570077896118, 9.477228559262585e-06, 0.002040311461314559, 0.06283417344093323, 9.536752259009518e-07, 0.029663249850273132, 1.958518624305725, 0.0063702124170959, 0.023949643597006798, 0.0024272012524306774, 0.03197100758552551, 0.0037426904309540987, 0.0017690624808892608, 0.0796562060713768, 0.049548931419849396, 1.1086586710007396e-05, 0.2389984279870987, 0.011775994673371315, 8.786496618995443e-05, 0.0004957689088769257, 0.1934920996427536, 0.00033863921999000013, 0.0014815203612670302, 0.06556656211614609, 0.022590607404708862, 0.026429247111082077, 1.958518624305725, 1.47821701830253e-05, 0.015980711206793785, 0.000256365688983351, 0.00011135387467220426, 0.0037524790968745947, 0.00030789317679591477, 3.635896518972004e-06, 0.00012280064402148128, 0.000174105676705949, 0.0019126413390040398, 1.958518624305725, 6.0442762332968414e-05, 0.01091877743601799, 0.00013761625450570136, 0.0015903644962236285, 0.019643783569335938, 0.0008209228399209678, 0.03523688763380051, 1.958518624305725, 0.026461893692612648, 0.03176279738545418, 0.0007021885248832405, 0.00626029260456562, 1.958518624305725, 1.958518624305725, 0.0006554248393513262, 0.00692210765555501, 0.08322172611951828, 1.958518624305725, 0.16702917218208313, 0.002923315390944481, 0.0013142498210072517, 0.06373786926269531, 0.0202775988727808, 0.7654964923858643, 0.00012584123760461807, 0.0032129178289324045, 1.958518624305725, 0.39535731077194214, 0.0025987690314650536, 0.0390198789536953, 0.007195290643721819, 0.0016797652933746576, 1.8786697387695312, 8.160541619872674e-05, 0.0013824424240738153, 0.000532284495420754, 0.06195969879627228, 0.00023692498507443815, 0.03752190247178078, 0.005951789673417807, 0.0010197421070188284, 0.0031050394754856825, 0.00010199395183008164, 0.0006258230423554778, 0.005290895700454712, 0.012392881326377392, 0.0071519664488732815, 4.231947514199419e-06, 0.0006645563989877701, 0.03531469777226448, 0.001000152318738401, 0.0009531218674965203, 0.012846757657825947, 0.0006194970919750631, 0.1373990774154663, 0.016928531229496002, 0.01851520501077175, 0.17266258597373962, 0.0001489443820901215, 0.04904692620038986, 8.208233339246362e-05, 0.012137027457356453, 0.002709474880248308, 0.02149459533393383, 3.248558641644195e-05, 1.958518624305725, 0.002255991566926241, 1.958518624305725, 0.018507134169340134, 1.958518624305725, 0.00021524888870771974, 0.020303327590227127, 0.0001327869831584394, 0.006928000133484602, 0.0007582390680909157, 5.960465188081798e-08, 2.3841863594498136e-07, 0.006252114661037922, 1.0430824204377132e-06, 0.023601289838552475, 9.457171108806506e-05, 0.00023716352006886154, 0.00023758094175718725, 0.0030261774081736803, 0.4678756594657898, 0.0003362534334883094, 0.0007993706967681646, 0.0002374020405113697, 0.0020262771286070347, 0.00013239945110399276, 0.0003413232625462115, 0.0009327583247795701, 1.3202603440731764e-05, 0.0018870931817218661, 0.00012894146493636072, 0.00030998061993159354, 1.361984686809592e-05, 0.008354121819138527, 4.103948231204413e-05, 0.00015896104741841555, 0.00029065710259601474, 0.00022213623742572963, 0.0017927502049133182, 0.00012080340820830315, 0.03484025597572327, 0.00019250044715590775, 0.0010069310665130615, 0.0023669209331274033, 6.741740071447566e-05, 0.00045663100900128484, 0.00021062756422907114, 0.15710516273975372, 0.0019407636718824506, 1.958518624305725, 2.081101894378662, 0.0013362126192077994, 3.361815106472932e-05, 0.0015092897228896618, 0.20258937776088715, 0.0008555217063985765, 0.017199186608195305, 1.2189298104203772e-05, 5.066397648079146e-07, 0.0038272514939308167, 0.02280726097524166, 0.0016014266293495893, 0.013296334072947502, 0.00019929803966078907, 1.958518624305725, 0.0017793509177863598, 0.0003458861610852182, 0.018670760095119476, 0.002725176280364394, 5.0517486670287326e-05, 0.0015103359473869205, 0.002969182562083006, 3.576280107608909e-07, 1.958518624305725, 0.0722765177488327, 0.00022398481087293476, 3.2484635994478595e-06, 0.00331469951197505, 8.00256384536624e-05, 0.016112947836518288, 9.656046131567564e-06, 1.958518624305725, 0.011247796006500721, 0.01647503301501274, 0.1023053452372551, 0.00037755913217552006, 4.887604973191628e-06, 0.002606678055599332, 0.003571059787645936, 0.006934647914022207, 0.0039815763011574745, 5.1977953262394294e-05, 0.06325220316648483, 0.003423073096200824, 4.768373855768004e-07, 0.00495445542037487, 0.0005778133636340499, 0.00026677214191295207, 0.037218447774648666, 1.1950874068133999e-05, 1.958518624305725, 0.0051727816462516785, 0.09657765179872513, 2.115969436999876e-06, 0.01180141232907772, 7.3314249675604515e-06, 1.0222301170870196e-05, 0.05022312328219414, 0.0019622454419732094, 0.0003956034779548645, 1.5497231515837484e-06, 4.112737315153936e-06, 0.008397337980568409, 0.00044437122414819896, 4.077123958268203e-05, 0.002012273296713829, 0.0001891911233542487, 0.00026811397401615977, 0.012228303588926792, 0.004546778742223978, 1.2071599960327148, 0.08941543102264404, 9.268607755075209e-06, 0.005245869513601065, 0.0010049601551145315, 0.011274589225649834, 0.9698341488838196, 0.0012818899704143405, 3.242597813368775e-05]



primu_wo = [0.584497332572937, 1.958518624305725, 0.0012088415678590536, 1.958518624305725, 0.002323055174201727, 1.958518624305725, 0.0004224176809657365, 0.00602927478030324, 1.958518624305725, 0.11586585640907288, 0.0023172167129814625, 0.0025892427656799555, 0.0577181838452816, 0.17370545864105225, 0.022934606298804283, 0.07787417620420456, 0.17086674273014069, 1.958518624305725, 0.031609341502189636, 0.014743893407285213, 0.1436159461736679, 0.1290397346019745, 0.027417093515396118, 0.020138856023550034, 1.958518624305725, 0.12055137753486633, 1.958518624305725, 0.010336533188819885, 1.958518624305725, 0.0019641302060335875, 0.5478024482727051, 6.166481034597382e-05, 0.0021751681342720985, 0.05750960484147072, 0.002228360390290618, 0.008539832197129726, 0.11565210670232773, 0.008262913674116135, 1.9342081941431388e-05, 0.0031922522466629744, 0.003219426842406392, 0.0009288768051192164, 0.015040211379528046, 0.013076726347208023, 0.27555781602859497, 0.00398479076102376, 0.017680667340755463, 0.05687915161252022, 1.958518624305725, 0.10006602108478546, 0.0017859010258689523, 0.010146262124180794, 0.0485084094107151, 0.051234036684036255, 0.015394143760204315, 0.013016709126532078, 0.0189743060618639, 0.00059855030849576, 0.035150106996297836, 0.0802721455693245, 1.958518624305725, 0.0036397110670804977, 0.00010124874097527936, 0.0026628824416548014, 1.958518624305725, 0.001738318125717342, 1.958518624305725, 0.0367048978805542, 1.958518624305725, 0.01079226192086935, 0.4766511917114258, 1.958518624305725, 0.024707727134227753, 0.17346827685832977, 0.19915331900119781, 0.20568662881851196, 0.041677091270685196, 0.10153908282518387, 0.09615698456764221, 0.00011373859888408333, 1.7971124179894105e-05, 0.0002461681724525988, 0.00011955140507780015, 0.003914169501513243, 0.004318234045058489, 3.1888587272987934e-06, 0.015464160591363907, 0.00012974634591955692, 0.006975293625146151, 0.034375205636024475, 0.024546276777982712, 0.09909025579690933, 0.06189645081758499, 0.01096145436167717, 7.838072633603588e-06, 1.958518624305725, 0.004089523572474718, 0.7861315011978149, 0.09251287579536438, 0.20730987191200256, 0.006465393118560314, 1.958518624305725, 0.011813526973128319, 0.0014321134658530354, 0.002846040530130267, 0.021329203620553017, 0.08189748972654343, 0.06852443516254425, 0.01540019828826189, 0.02696329541504383, 1.958518624305725, 0.15424998104572296, 0.0016838321462273598, 0.01337156817317009, 0.0040418412536382675, 1.958518624305725, 0.012300719507038593, 1.024859070777893, 1.958518624305725, 0.1484205424785614, 0.0006261214148253202, 1.958518624305725, 0.00021751485473942012, 0.0013900331687182188, 0.029967596754431725, 0.0003806310996878892, 0.5047163367271423, 1.958518624305725, 4.404977153171785e-05, 0.011793570592999458, 0.026545105502009392, 0.07525375485420227, 0.01523229293525219, 0.16672208905220032, 0.009728680364787579, 1.958518624305725, 0.02168089523911476, 0.00028493176796473563, 0.0015429796185344458, 0.00015624819207005203, 1.958518624305725, 0.025379382073879242, 1.958518624305725, 0.023439040407538414, 0.026727385818958282, 0.0010514578316360712, 0.006733070593327284, 1.958518624305725, 0.003480450017377734, 0.542220950126648, 1.958518624305725, 0.002581933280453086, 0.004712787922471762, 0.031946100294589996, 0.007422189693897963, 1.958518624305725, 0.03195032477378845, 0.08428574353456497, 1.958518624305725, 1.3768862118013203e-05, 0.0027162767946720123, 0.010294062085449696, 0.01112811453640461, 1.958518624305725, 1.958518624305725, 0.011521218344569206, 4.461606658878736e-05, 0.014279123395681381, 0.0012375817168504, 0.04740022122859955, 1.958518624305725, 0.004679786041378975, 0.08000434935092926, 0.00110333610791713, 0.00038116794894449413, 0.1650586873292923, 0.00080522132338956, 0.011034632101655006, 0.010742169804871082, 0.004299837164580822, 0.6926600933074951, 0.11410137265920639, 1.958518624305725, 0.0006882514571771026, 0.0019851343240588903, 0.00853040348738432, 1.958518624305725, 0.15884368121623993, 0.08401931822299957, 1.958518624305725, 1.958518624305725, 0.0069427466951310635, 0.0032781301997601986, 0.0003656591579783708, 4.509294740273617e-05, 2.1130292225279845e-05, 0.0004279954591766, 0.012776769697666168, 0.00036067856126464903, 1.0698524713516235, 0.002035553567111492, 0.0013479265617206693, 8.642748070997186e-06, 0.00012300931848585606, 0.019565554335713387, 1.958518624305725, 0.0036536105908453465, 0.011975769884884357, 0.7932458519935608, 1.958518624305725, 0.06972284615039825, 0.12027227133512497, 0.04696616530418396, 9.238728466698376e-07, 0.0005886740400455892, 0.012235327623784542, 0.0019820225425064564, 0.007349750958383083, 0.03881428390741348, 0.0011543834116309881, 0.031060954555869102, 2.7389083697926253e-05, 0.0006069945520721376, 0.004040879663079977, 1.958518624305725, 0.11445067822933197, 0.02518543228507042, 0.00394868291914463, 0.00020654294348787516, 0.000380034587578848, 0.00019902971689589322, 0.17988845705986023, 0.017885565757751465, 0.003824398387223482, 1.958518624305725, 1.958518624305725, 0.005449649877846241, 0.0010267301695421338, 1.1205798728042282e-05, 0.007987330667674541, 7.433251448674127e-05, 0.0029644756577908993, 1.958518624305725, 0.0005661472678184509, 0.01684366725385189, 0.00013383034092839807, 0.00022499854094348848, 0.011229599826037884, 4.887604973191628e-06, 0.011685105971992016, 0.053109411150217056, 0.0050189620815217495, 0.14407123625278473, 0.002439749427139759, 0.08328266441822052, 0.007650947663933039, 0.006330461241304874, 0.0013888078974559903, 0.027621516957879066, 2.9058108339086175e-05, 0.03583303093910217, 0.02340499870479107, 0.00021047849440947175, 0.009827845729887486, 0.03675047308206558, 0.01705334149301052, 0.0026930845342576504, 4.357289435574785e-05, 0.3341563045978546, 8.324481314048171e-05, 1.0848162673937622e-05, 1.958518624305725, 0.18792767822742462, 4.768373855768004e-07, 8.753708243602887e-05, 0.00021867765462957323, 0.0014120590640231967, 1.624252945475746e-05, 0.002375934040173888, 1.958518624305725, 0.005652217660099268, 8.422845712630078e-05, 0.01328347995877266, 0.004012038465589285, 0.005532632116228342, 1.958518624305725, 2.533203769417014e-06, 0.023361464962363243, 1.958518624305725, 0.006921291816979647, 3.1829891668166965e-05, 0.024245087057352066, 1.958518624305725, 0.04655037820339203, 0.00048499973490834236, 0.005145771894603968, 0.008338727988302708, 1.958518624305725, 0.2164965718984604, 0.015778837725520134, 0.0011977284448221326, 0.017288153991103172, 1.958518624305725, 0.0599110871553421, 9.66284642345272e-05, 0.004095833748579025, 0.0005101182614453137, 0.0032465727999806404, 0.16470754146575928, 7.510749128414318e-05, 0.2209027111530304, 0.05399319529533386, 3.725428905454464e-05, 0.0004444607184268534, 7.632957567693666e-05, 0.039762645959854126, 8.94069742685133e-08, 0.0007511354051530361, 2.861031134671066e-06, 0.0006706740241497755, 0.006419626995921135, 1.2278707799850963e-05, 0.00046068785013630986, 0.003265321021899581, 0.00042483373545110226, 0.00010849222599063069, 0.00043336450471542776, 0.0004485771059989929, 1.958518624305725, 0.0007049341802485287, 0.032789092510938644, 1.958518624305725, 0.01770191080868244, 0.0003999282489530742, 0.0910816565155983, 0.0037392673548310995, 0.016922149807214737, 0.0004710388893727213, 0.0057935696095228195, 1.3018821477890015, 0.021772902458906174, 0.010955879464745522, 0.021592793986201286, 4.0026119677349925e-05, 0.037419531494379044, 0.17822377383708954, 0.0006752697518095374, 0.00020105708972550929, 0.0019942603539675474, 0.00015481722948607057, 9.579383913660422e-05, 0.0010833546984940767, 1.958518624305725, 0.0063192034140229225, 0.00011138368427054957, 0.3173527419567108, 0.005759018938988447, 0.01076936163008213, 0.003024048637598753, 1.958518624305725, 0.0012979351449757814, 0.00683155283331871, 0.04344732314348221, 0.23559945821762085, 0.029391737654805183, 0.007051003165543079, 0.004340569954365492, 0.0009722918039187789, 0.004197494592517614, 0.0015283614629879594, 7.489884592359886e-05, 0.00031123310327529907, 1.958518624305725, 8.109869668260217e-05, 0.0036173465196043253, 0.39643070101737976, 0.002944569569081068, 0.0011266935616731644, 6.208209379110485e-05, 0.0019155432237312198, 0.001237940159626305, 0.0006754786591045558, 5.108378900331445e-05, 0.05773270130157471, 0.0031875132117420435, 0.00046939821913838387, 2.0146775568719022e-05, 0.0001678152329986915, 8.858034561853856e-05, 0.02416306920349598, 0.00012962710752617568, 0.003767462680116296, 0.007466202601790428, 0.004049472510814667, 0.028561675921082497, 3.87431691706297e-06, 1.1920930376163597e-07, 1.58252842084039e-05, 0.0005967898759990931, 0.26511508226394653, 0.000988984014838934, 2.7597712687565945e-05, 1.68683982337825e-05, 4.571885438053869e-05, 9.715651685837656e-06, 1.6391304598073475e-06, 2.5869085220620036e-05, 0.0004818376328330487, 0.007183378096669912, 0.00032551749609410763, 1.958518624305725, 0.11589144915342331, 1.958518624305725, 4.768373855768004e-07, 6.011489676893689e-05, 4.053132215631194e-06, 0.3849104940891266, 3.1442439649254084e-05, 0.0009329673484899104, 0.003096733009442687, 0.0005452624754980206, 1.958518624305725, 0.00016188262088689953, 0.06417061388492584, 0.35968145728111267, 0.0009475680999457836, 9.28130466490984e-05, 0.24778324365615845, 0.00214808015152812, 0.004539831541478634, 0.0008215497364290059, 0.0060202255845069885, 0.0009161575580947101, 0.3199354112148285, 0.00040285123395733535, 4.529973466560477e-06, 0.002558627398684621, 0.008192503824830055, 0.015150019899010658, 5.126025826029945e-06, 0.0037777323741465807, 0.003566047176718712, 7.153068872867152e-05, 0.016112977638840675, 0.001314668101258576, 4.6255343477241695e-05, 0.00013272734940983355, 0.0021577777806669474, 0.0006250770529732108, 1.958518624305725, 2.9028304197709076e-05, 0.0034846514463424683, 0.6617805361747742, 0.00014226672647055238, 0.0026011657901108265, 0.0004167803272139281, 1.958518624305725, 0.0018304373370483518, 6.765584839740768e-05, 0.0001605410798219964, 0.006342383101582527, 0.0017292266711592674, 0.0086269062012434, 1.958518624305725, 0.030320636928081512, 0.00020424721878953278, 0.039006829261779785, 1.958518624305725, 0.0004637305100914091, 0.00016954434977378696, 8.344720299646724e-06, 0.002384827472269535, 0.0013021184131503105, 0.0065750256180763245, 0.00010604791168589145, 0.001887541962787509, 5.662473540724022e-06, 0.005637147463858128, 1.958518624305725, 0.00317410659044981, 1.958518624305725, 0.0021467930637300014, 1.958518624305725, 0.0019067478133365512, 0.09431329369544983, 0.0023114681243896484, 9.343901183456182e-05, 4.142540092288982e-06, 2.17859724216396e-05, 0.02822551503777504, 0.05798343941569328, 4.562943649943918e-05, 0.00020710942044388503, 0.017708981409668922, 0.00876846443861723, 0.0017155301757156849, 0.2836942672729492, 0.02243124321103096, 0.00011579543206607923, 0.0012533266562968493, 0.00035286476486362517, 0.008485296741127968, 0.3924034833908081, 0.0009531218674965203, 0.7238205075263977, 0.0027457328978925943, 0.03650355711579323, 1.958518624305725, 0.014545679092407227, 0.0020110763143748045, 0.13757245242595673, 0.015158099122345448, 0.00016131618758663535, 0.0001718100975267589, 0.13660824298858643, 0.0001744932378642261, 0.00019205323769710958, 2.634594784467481e-05, 0.15639884769916534, 0.0010804577032104135, 6.473483517765999e-05, 0.019044144079089165, 1.958518624305725, 0.0001725554175209254, 0.0016152097377926111, 6.0797106016252656e-06, 0.00021805152937304229, 0.026834730058908463, 9.516787395114079e-05, 1.958518624305725, 0.012481851503252983, 0.012341742403805256, 0.00037356262328103185, 0.029630236327648163, 0.005207442212849855, 0.019008388742804527, 0.0012100067688152194, 0.027359798550605774, 0.0007125744014047086, 2.4140463210642338e-05]




x=[]
y_unl_s = []
y_unl_self_s =[]
y_nips_rkl_s =[]

y_bfu_acc_list = []
y_primu_wo =[]
step_num = 20
for i in range(20):
    # print(np.random.laplace(0, 1)/10+0.2)
    x.append(i)
    #y_fkl[i] = y_fkl[i*2]*100
    acc_now = y_bfu_acc[i*15]
    acc_now_wo = primu_wo[i*15]
    for j in range(step_num):
        if y_bfu_acc[i*15+j+1] > 1:
            y_bfu_acc[i * 15 + j + 1] = 0.4

        if primu_wo[i*15+j+1] > 1:
            primu_wo[i * 15 + j + 1] = 0.4
        acc_now += y_bfu_acc[i*15+j+1]
        acc_now_wo += primu_wo[i*15+j+1]
    acc_avg = acc_now/step_num
    acc_avg_wo = acc_now_wo/step_num

    y_bfu_acc_list.append(acc_avg)
    y_primu_wo.append(acc_avg_wo)

    # y_hfu_back_acc[i] = y_hfu_back_acc[i]*100
    # y_hfu_acc[i] = y_hfu_acc[i]*100


plt.figure()
lw=4
# plt.plot(x, y_bfu_acc_list, color='orange',  marker='x',  label='BFU',linewidth=4,  markersize=10)
# plt.plot(x, y_primu_wo, color='b',  marker='x',  label='BFU2',linewidth=4,  markersize=10)
plt.plot(x, y_bfu_acc_list, color='g', linestyle='-',  label='PriMU$_{w}$',linewidth=lw, markersize=10)
# #plt.plot(x, y_fkl, color='g',  marker='+',  label='VRFL')
plt.plot(x, y_primu_wo, color='b', linestyle=(0,(3,1,1,1)),  label='PriMU$_{w/o}$',linewidth=lw, markersize=10)

# plt.plot(x, unl_fr, color='blue', marker='^', label='Retrain',linewidth=4, markersize=10)
# plt.plot(x, unl_br, color='orange',  marker='x',  label='BFU',linewidth=4,  markersize=10)
# plt.plot(x, unl_self_r, color='g',  marker='*',  label='BFU-SS',linewidth=4, markersize=10)
# plt.plot(x, unl_hess_r, color='r',  marker='p',  label='HFU',linewidth=4, markersize=10)

# plt.plot(x, y_unl_s, color='b', marker='^', label='Normal Bayessian Fed Unlearning',linewidth=3, markersize=8)
# plt.plot(x, y_unl_self_s, color='r',  marker='x',  label='Self-sharing Fed Unlearning',linewidth=3, markersize=8)
# #plt.plot(x, y_fkl, color='g',  marker='+',  label='VRFL')
# plt.plot(x, y_hessian_30_s, color='y',  marker='*',  label='Unlearning INFOCOM22',linewidth=3, markersize=8)


# plt.grid()
leg = plt.legend(fancybox=True, shadow=True)
plt.xlabel('Epochs' ,fontsize=20)
plt.ylabel('MI of $I(Z_e;Z_a)$' ,fontsize=20)
my_y_ticks = np.arange(0 ,0.5,0.1)
plt.yticks(my_y_ticks,fontsize=20)
my_x_ticks = np.arange(0, 21, 5)
plt.xticks(my_x_ticks,my_x_ticks*2,fontsize=20)
plt.title('(a) On MNIST',fontsize=20)
plt.legend(loc='best',fontsize=20)
plt.tight_layout()
#plt.title("Fashion MNIST")
plt.rcParams['figure.figsize'] = (2.0, 1)
plt.rcParams['image.interpolation'] = 'nearest'
plt.rcParams['figure.subplot.left'] = 0.11
plt.rcParams['figure.subplot.bottom'] = 0.08
plt.rcParams['figure.subplot.right'] = 0.977
plt.rcParams['figure.subplot.top'] = 0.969
plt.savefig('mnist_client_mutual_info_detail.pdf', format='pdf', dpi=200)
plt.show()